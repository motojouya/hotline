(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=1)})([function(module,exports){function isObject(obj){return null!==obj&&"object"===typeof obj}module.exports=isObject},function(module,exports,__webpack_require__){"use strict";var _app=__webpack_require__(2);var _app2=_interopRequireDefault(_app);var _xhr_mock=__webpack_require__(3);var _xhr_mock2=_interopRequireDefault(_xhr_mock);var _store=__webpack_require__(10);var _store2=_interopRequireDefault(_store);var _riot=__webpack_require__(11);var _riot2=_interopRequireDefault(_riot);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}window.addEventListner("DOMContentLoaded",function(event){var mainTag=document.getElementById("main");(0,_app2.default)(window,document,history,location,_xhr_mock2.default,_store2.default,mainTag,_riot2.default,function(isPause){var loadingClasses=document.getElementById("loading").classList;if(isPause){loadingClasses.remove("invisible")}else{loadingClasses.add("invisible")}})})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(win,doc,hstry,loc,xhr,getStore,mainTag,riot,pause){var relation_request_size=20;var voice_request_size=100;var store=getStore(riot.observable);var removeIfSuffix=function removeIfSuffix(path,suffix){if(path.endsWith(suffix)){path=path.slice(0,-1*suffix.length)}return path};var transfer=function transfer(href){var path=removeIfSuffix(href,"/"),nextState;switch(path){case"/app":nextState={pane:"menu"};hstry.pushState(nextState,"menu",href);return;case"/app/config":nextState={pane:"config"};hstry.pushState(nextState,"config",href);return;case"/app/relation":nextState={pane:"relation"};hstry.pushState(nextState,"relation",href);return;default:}if(path.startsWith("/app/relation/")){nextState={pane:"relation",relationNo:path.slice("/app/relation/".length).split("/")[0]};hstry.pushState(nextState,"relation",href);return}};var changeConfig=function changeConfig(payload){xhr.changeConfig(payload,function(err,res){var data,key;if(err){return}data=res.body;for(key in data){if(data.hasOwnProperty(key)){store.setConfig(key,data[key])}}})};var configThumbnail=function configThumbnail(file){xhr.configThumbnail(file,function(err,res){if(err){return}store.setConfig("thumbnail",res.body.payload)})};var configLoginPassword=function configLoginPassword(oldPassword,newPassword){var payload={oldPassword:oldPassword,newPassword:newPassword};xhr.changeConfig(payload,function(err,res){if(err){return}alert("passwordを変更しました")})};var makeRelation=function makeRelation(userid,countersign){xhr.makeRelation(userid,countersign,function(err,res){var data;if(err){return}data=res.body;store.setRelation(data.userid,data)})};var breakRelation=function breakRelation(userid){xhr.breakRelation(userid,function(err,res){var data;if(err){return}data=res.body;store.setRelation(data.userid,data)})};var wsConn=null;var makeWSConnction=function makeWSConnction(){wsConn=xhr.connectWebSocket(function(data){switch(data.type){case"RELATION":store.setRelations(data.relations);case"VOICE":store.setVoices(data.userid,data.voices);default:}})};var sendWSMessage=function sendWSMessage(payload){wsConn.send(payload)};var closeWSConnection=function closeWSConnection(code,reason){wsConn.close(code,reason)};var loadRelations=function loadRelations(offset){xhr.getRelations(offset,relation_request_size,function(err,res){var data,payload;if(err){return}data=res.body;payload=data.payload;store.setRelations(payload);if(data.hasNext){getRelations(offset+payload.length)}})};var loadConfig=function loadConfig(){xhr.getConfig(function(err,res){if(err){return}store.setConfig(res.body.payload)})};var replaceInitialState=function replaceInitialState(href,pathName){var path=removeIfSuffix(pathName,"/"),firstLoadedState;switch(path){case"/app":firstLoadedState={pane:"menu"};hstry.replaceState(firstLoadedState,"menu",href);return firstLoadedState;case"/app/config":firstLoadedState={pane:"config"};hstry.replaceState(firstLoadedState,"config",href);return firstLoadedState;case"/app/relation":firstLoadedState={pane:"relation"};hstry.replaceState(firstLoadedState,"relation",href);return firstLoadedState;default:}if(path.startsWith("/app/relation/")){firstLoadedState={pane:"relation",relationNo:path.slice("/app/relation/".length).split("/")[0]};hstry.replaceState(firstLoadedState,"relation",href);return firstLoadedState}};var domItems={};var change=function change(tagName,tagId,opts){var div=doc.createElement("div"),tag=doc.createElement("menu"),script=doc.createElement("script");for(var key in domItems){if(domItems.hasOwnProperty(key)){domitems[key].parentNode.removeChild(domitems[key])}}pause(true);script.onload=function(){riot.mount("#"+tagId,tagName,opts);pause(false)};script.src="/lib/"+tagname+".tag";div.apendChild(script);div.apendChild(tag);div.setAttribute("id",tagId);mainTag.apendChild(div);domItems[tagId]=div};var changeState=function changeState(state){switch(state.pane){case"menu":return change("menu","menu",{schema:store.getRelations(),duties:{transfer:transfer}});case"config":return change("config","config",{schema:store.getConfig(),duties:{changeConfig:changeConfig,configThumbnail:configThumbnail,configLoginPassword:configLoginPassword,transfer:transfer}});case"relation":var relation=store.getRelation(state.relationNo);if(relation&&relation.status=="ACTIVE"){return change("chat"+relationNo,"chat",{schema:{relation:relation,voices:store.getVoices(relation.userid)},duties:{sendMessage:sendWSMessage,breakRelation:breakRelation,transfer:transfer}})}else{return change("relate","relate",{schema:relation,duties:{makeRelation:makeRelation,breakRelation:breakRelation,transfer:transfer}})}default:}};var init=function init(){loadRelations(0);loadConfig();makeWSConnction();win.addEventListener("popstate",function(event){changeState(event.state)});changeState(replaceInitialState(loc.href,loc.pathname))};init()}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _superagent=__webpack_require__(4);var _superagent2=_interopRequireDefault(_superagent);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var links=[{no:1,apply:"hamada",accept:"matsumoto",status:1,clap:"2017-07-02 10:10:10",message:"2017-07-01 12:34:56",call:"2017-06-17 11:21:45"},{no:2,apply:"matsumoto",accept:"hamada",status:1,clap:"2017-04-09 23:12:11",message:"2017-04-09 23:12:21",call:null}];var voices=[{no:1,speak_at:"2017-07-01 12:34:56",userid:"hamada",message:"今日の夕飯なにかな？",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:34:57",userid:"matsumoto",message:"んー",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:34:58",userid:"hamada",message:"カレーかな？",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:34:59",userid:"matsumoto",message:"まだ考えてない。。。",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:34:00",userid:"hamada",message:"そっか",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:10",userid:"hamada",message:"それならさ",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:11",userid:"hamada",message:"そとで食べようよ",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:12",userid:"hamada",message:"カレーでもいいし",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:16",userid:"matsumoto",message:"ホント？",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:17",userid:"matsumoto",message:"助かる",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:18",userid:"hamada",message:"うん",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:22",userid:"hamada",message:"いつもご飯作ってくれてるから",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:23",userid:"hamada",message:"今日はいいんだよ",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:25",userid:"matsumoto",message:"ありがとう",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-01 12:35:27",userid:"hamada",message:"どういたしまして",meta_flag:null,file_no:null,tel_flag:null},{no:1,speak_at:"2017-07-02 10:10:10",userid:"hamada",message:"",meta_flag:null,file_no:null,tel_flag:null}];var connectWebSocket=function connectWebSocket(callback,recover){var wsSend=function wsSend(message){callback(message)};var wsClose=function wsClose(code,reason){console.log("just closed."+code+"data"+reason)};return{send:wsSend,close:wsClose}};var makeRelation=function makeRelation(userid,countersign,callback){if(userid==="yamada"&&countersign==="america"){callback(null,{isSuccess:true,message:"ツナガルリクエストを送信しました",userid:userid})}else{callback(null,{isSuccess:false,message:"拒否されました",userid:userid})}};var breakRelation=function breakRelation(userid,callback){callback(null,{isSuccess:true,message:"関係を解消しました",userid:userid})};var getRelations=function getRelations(offset,limit,callback){callback(null,{isSuccess:true,message:"",result:links})};var getVoices=function getVoices(userid,offset,limit,callback){callback(null,{isSuccess:true,message:"",result:voices})};var getConfig=function getConfig(callback){callback(null,{userid:"userid",name:"",email:"test@gmail.com",countersign:"peru",colorNumber:4,thumbnail:"",notification:0})};var changeConfig=function changeConfig(payload,callback){callback(null,{isSuccess:true,payload:payload})};var configThumbnail=function configThumbnail(file,callback){callback(null,{isSuccess:true,file:file,message:"サムネイル画像を変更しました"})};exports.default={connectWebSocket:connectWebSocket,getRelations:getRelations,makeRelation:makeRelation,breakRelation:breakRelation,getVoices:getVoices,getConfig:getConfig,changeConfig:changeConfig,configThumbnail:configThumbnail}},function(module,exports,__webpack_require__){var root;if(typeof window!=="undefined"){root=window}else if(typeof self!=="undefined"){root=self}else{console.warn("Using browser-only version of superagent in non-browser environment");root=this}var Emitter=__webpack_require__(5);var RequestBase=__webpack_require__(6);var isObject=__webpack_require__(0);var ResponseBase=__webpack_require__(7);var shouldRetry=__webpack_require__(9);function noop(){}var request=exports=module.exports=function(method,url){if("function"==typeof url){return new exports.Request("GET",method).end(url)}if(1==arguments.length){return new exports.Request("GET",method)}return new exports.Request(method,url)};exports.Request=Request;request.getXHR=function(){if(root.XMLHttpRequest&&(!root.location||"file:"!=root.location.protocol||!root.ActiveXObject)){return new XMLHttpRequest}else{try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}throw Error("Browser-only version of superagent could not find XHR")};var trim="".trim?function(s){return s.trim()}:function(s){return s.replace(/(^\s*|\s*$)/g,"")};function serialize(obj){if(!isObject(obj))return obj;var pairs=[];for(var key in obj){pushEncodedKeyValuePair(pairs,key,obj[key])}return pairs.join("&")}function pushEncodedKeyValuePair(pairs,key,val){if(val!=null){if(Array.isArray(val)){val.forEach(function(v){pushEncodedKeyValuePair(pairs,key,v)})}else if(isObject(val)){for(var subkey in val){pushEncodedKeyValuePair(pairs,key+"["+subkey+"]",val[subkey])}}else{pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(val))}}else if(val===null){pairs.push(encodeURIComponent(key))}}request.serializeObject=serialize;function parseString(str){var obj={};var pairs=str.split("&");var pair;var pos;for(var i=0,len=pairs.length;i<len;++i){pair=pairs[i];pos=pair.indexOf("=");if(pos==-1){obj[decodeURIComponent(pair)]=""}else{obj[decodeURIComponent(pair.slice(0,pos))]=decodeURIComponent(pair.slice(pos+1))}}return obj}request.parseString=parseString;request.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};request.serialize={"application/x-www-form-urlencoded":serialize,"application/json":JSON.stringify};request.parse={"application/x-www-form-urlencoded":parseString,"application/json":JSON.parse};function parseHeader(str){var lines=str.split(/\r?\n/);var fields={};var index;var line;var field;var val;lines.pop();for(var i=0,len=lines.length;i<len;++i){line=lines[i];index=line.indexOf(":");field=line.slice(0,index).toLowerCase();val=trim(line.slice(index+1));fields[field]=val}return fields}function isJSON(mime){return/[\/+]json\b/.test(mime)}function Response(req){this.req=req;this.xhr=this.req.xhr;this.text=this.req.method!="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType==="undefined"?this.xhr.responseText:null;this.statusText=this.req.xhr.statusText;var status=this.xhr.status;if(status===1223){status=204}this._setStatusProperties(status);this.header=this.headers=parseHeader(this.xhr.getAllResponseHeaders());this.header["content-type"]=this.xhr.getResponseHeader("content-type");this._setHeaderProperties(this.header);if(null===this.text&&req._responseType){this.body=this.xhr.response}else{this.body=this.req.method!="HEAD"?this._parseBody(this.text?this.text:this.xhr.response):null}}ResponseBase(Response.prototype);Response.prototype._parseBody=function(str){var parse=request.parse[this.type];if(this.req._parser){return this.req._parser(this,str)}if(!parse&&isJSON(this.type)){parse=request.parse["application/json"]}return parse&&str&&(str.length||str instanceof Object)?parse(str):null};Response.prototype.toError=function(){var req=this.req;var method=req.method;var url=req.url;var msg="cannot "+method+" "+url+" ("+this.status+")";var err=new Error(msg);err.status=this.status;err.method=method;err.url=url;return err};request.Response=Response;function Request(method,url){var self=this;this._query=this._query||[];this.method=method;this.url=url;this.header={};this._header={};this.on("end",function(){var err=null;var res=null;try{res=new Response(self)}catch(e){err=new Error("Parser is unable to parse the response");err.parse=true;err.original=e;if(self.xhr){err.rawResponse=typeof self.xhr.responseType=="undefined"?self.xhr.responseText:self.xhr.response;err.status=self.xhr.status?self.xhr.status:null;err.statusCode=err.status}else{err.rawResponse=null;err.status=null}return self.callback(err)}self.emit("response",res);var new_err;try{if(!self._isResponseOK(res)){new_err=new Error(res.statusText||"Unsuccessful HTTP response");new_err.original=err;new_err.response=res;new_err.status=res.status}}catch(e){new_err=e}if(new_err){self.callback(new_err,res)}else{self.callback(null,res)}})}Emitter(Request.prototype);RequestBase(Request.prototype);Request.prototype.type=function(type){this.set("Content-Type",request.types[type]||type);return this};Request.prototype.accept=function(type){this.set("Accept",request.types[type]||type);return this};Request.prototype.auth=function(user,pass,options){if(typeof pass==="object"&&pass!==null){options=pass}if(!options){options={type:"function"===typeof btoa?"basic":"auto"}}switch(options.type){case"basic":this.set("Authorization","Basic "+btoa(user+":"+pass));break;case"auto":this.username=user;this.password=pass;break;case"bearer":this.set("Authorization","Bearer "+user);break}return this};Request.prototype.query=function(val){if("string"!=typeof val)val=serialize(val);if(val)this._query.push(val);return this};Request.prototype.attach=function(field,file,options){if(file){if(this._data){throw Error("superagent can't mix .send() and .attach()")}this._getFormData().append(field,file,options||file.name)}return this};Request.prototype._getFormData=function(){if(!this._formData){this._formData=new root.FormData}return this._formData};Request.prototype.callback=function(err,res){if(this._maxRetries&&this._retries++<this._maxRetries&&shouldRetry(err,res)){return this._retry()}var fn=this._callback;this.clearTimeout();if(err){if(this._maxRetries)err.retries=this._retries-1;this.emit("error",err)}fn(err,res)};Request.prototype.crossDomainError=function(){var err=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");err.crossDomain=true;err.status=this.status;err.method=this.method;err.url=this.url;this.callback(err)};Request.prototype.buffer=Request.prototype.ca=Request.prototype.agent=function(){console.warn("This is not supported in browser version of superagent");return this};Request.prototype.pipe=Request.prototype.write=function(){throw Error("Streaming is not supported in browser version of superagent")};Request.prototype._isHost=function _isHost(obj){return obj&&"object"===typeof obj&&!Array.isArray(obj)&&Object.prototype.toString.call(obj)!=="[object Object]"};Request.prototype.end=function(fn){if(this._endCalled){console.warn("Warning: .end() was called twice. This is not supported in superagent")}this._endCalled=true;this._callback=fn||noop;this._finalizeQueryString();return this._end()};Request.prototype._end=function(){var self=this;var xhr=this.xhr=request.getXHR();var data=this._formData||this._data;this._setTimeouts();xhr.onreadystatechange=function(){var readyState=xhr.readyState;if(readyState>=2&&self._responseTimeoutTimer){clearTimeout(self._responseTimeoutTimer)}if(4!=readyState){return}var status;try{status=xhr.status}catch(e){status=0}if(!status){if(self.timedout||self._aborted)return;return self.crossDomainError()}self.emit("end")};var handleProgress=function(direction,e){if(e.total>0){e.percent=e.loaded/e.total*100}e.direction=direction;self.emit("progress",e)};if(this.hasListeners("progress")){try{xhr.onprogress=handleProgress.bind(null,"download");if(xhr.upload){xhr.upload.onprogress=handleProgress.bind(null,"upload")}}catch(e){}}try{if(this.username&&this.password){xhr.open(this.method,this.url,true,this.username,this.password)}else{xhr.open(this.method,this.url,true)}}catch(err){return this.callback(err)}if(this._withCredentials)xhr.withCredentials=true;if(!this._formData&&"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof data&&!this._isHost(data)){var contentType=this._header["content-type"];var serialize=this._serializer||request.serialize[contentType?contentType.split(";")[0]:""];if(!serialize&&isJSON(contentType)){serialize=request.serialize["application/json"]}if(serialize)data=serialize(data)}for(var field in this.header){if(null==this.header[field])continue;if(this.header.hasOwnProperty(field))xhr.setRequestHeader(field,this.header[field])}if(this._responseType){xhr.responseType=this._responseType}this.emit("request",this);xhr.send(typeof data!=="undefined"?data:null);return this};request.get=function(url,data,fn){var req=request("GET",url);if("function"==typeof data)fn=data,data=null;if(data)req.query(data);if(fn)req.end(fn);return req};request.head=function(url,data,fn){var req=request("HEAD",url);if("function"==typeof data)fn=data,data=null;if(data)req.query(data);if(fn)req.end(fn);return req};request.options=function(url,data,fn){var req=request("OPTIONS",url);if("function"==typeof data)fn=data,data=null;if(data)req.send(data);if(fn)req.end(fn);return req};function del(url,data,fn){var req=request("DELETE",url);if("function"==typeof data)fn=data,data=null;if(data)req.send(data);if(fn)req.end(fn);return req}request["del"]=del;request["delete"]=del;request.patch=function(url,data,fn){var req=request("PATCH",url);if("function"==typeof data)fn=data,data=null;if(data)req.send(data);if(fn)req.end(fn);return req};request.post=function(url,data,fn){var req=request("POST",url);if("function"==typeof data)fn=data,data=null;if(data)req.send(data);if(fn)req.end(fn);return req};request.put=function(url,data,fn){var req=request("PUT",url);if("function"==typeof data)fn=data,data=null;if(data)req.send(data);if(fn)req.end(fn);return req}},function(module,exports,__webpack_require__){if(true){module.exports=Emitter}function Emitter(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in Emitter.prototype){obj[key]=Emitter.prototype[key]}return obj}Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){this._callbacks=this._callbacks||{};(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){function on(){this.off(event,on);fn.apply(this,arguments)}on.fn=fn;this.on(event,on);return this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length){delete this._callbacks["$"+event];return this}var cb;for(var i=0;i<callbacks.length;i++){cb=callbacks[i];if(cb===fn||cb.fn===fn){callbacks.splice(i,1);break}}return this};Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks["$"+event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;i<len;++i){callbacks[i].apply(this,args)}}return this};Emitter.prototype.listeners=function(event){this._callbacks=this._callbacks||{};return this._callbacks["$"+event]||[]};Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},function(module,exports,__webpack_require__){var isObject=__webpack_require__(0);module.exports=RequestBase;function RequestBase(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in RequestBase.prototype){obj[key]=RequestBase.prototype[key]}return obj}RequestBase.prototype.clearTimeout=function _clearTimeout(){clearTimeout(this._timer);clearTimeout(this._responseTimeoutTimer);delete this._timer;delete this._responseTimeoutTimer;return this};RequestBase.prototype.parse=function parse(fn){this._parser=fn;return this};RequestBase.prototype.responseType=function(val){this._responseType=val;return this};RequestBase.prototype.serialize=function serialize(fn){this._serializer=fn;return this};RequestBase.prototype.timeout=function timeout(options){if(!options||"object"!==typeof options){this._timeout=options;this._responseTimeout=0;return this}for(var option in options){switch(option){case"deadline":this._timeout=options.deadline;break;case"response":this._responseTimeout=options.response;break;default:console.warn("Unknown timeout option",option)}}return this};RequestBase.prototype.retry=function retry(count){if(arguments.length===0||count===true)count=1;if(count<=0)count=0;this._maxRetries=count;this._retries=0;return this};RequestBase.prototype._retry=function(){this.clearTimeout();if(this.req){this.req=null;this.req=this.request()}this._aborted=false;this.timedout=false;return this._end()};RequestBase.prototype.then=function then(resolve,reject){if(!this._fullfilledPromise){var self=this;if(this._endCalled){console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises")}this._fullfilledPromise=new Promise(function(innerResolve,innerReject){self.end(function(err,res){if(err)innerReject(err);else innerResolve(res)})})}return this._fullfilledPromise.then(resolve,reject)};RequestBase.prototype.catch=function(cb){return this.then(undefined,cb)};RequestBase.prototype.use=function use(fn){fn(this);return this};RequestBase.prototype.ok=function(cb){if("function"!==typeof cb)throw Error("Callback required");this._okCallback=cb;return this};RequestBase.prototype._isResponseOK=function(res){if(!res){return false}if(this._okCallback){return this._okCallback(res)}return res.status>=200&&res.status<300};RequestBase.prototype.get=function(field){return this._header[field.toLowerCase()]};RequestBase.prototype.getHeader=RequestBase.prototype.get;RequestBase.prototype.set=function(field,val){if(isObject(field)){for(var key in field){this.set(key,field[key])}return this}this._header[field.toLowerCase()]=val;this.header[field]=val;return this};RequestBase.prototype.unset=function(field){delete this._header[field.toLowerCase()];delete this.header[field];return this};RequestBase.prototype.field=function(name,val){if(null===name||undefined===name){throw new Error(".field(name, val) name can not be empty")}if(this._data){console.error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()")}if(isObject(name)){for(var key in name){this.field(key,name[key])}return this}if(Array.isArray(val)){for(var i in val){this.field(name,val[i])}return this}if(null===val||undefined===val){throw new Error(".field(name, val) val can not be empty")}if("boolean"===typeof val){val=""+val}this._getFormData().append(name,val);return this};RequestBase.prototype.abort=function(){if(this._aborted){return this}this._aborted=true;this.xhr&&this.xhr.abort();this.req&&this.req.abort();this.clearTimeout();this.emit("abort");return this};RequestBase.prototype.withCredentials=function(on){if(on==undefined)on=true;this._withCredentials=on;return this};RequestBase.prototype.redirects=function(n){this._maxRedirects=n;return this};RequestBase.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};RequestBase.prototype.send=function(data){var isObj=isObject(data);var type=this._header["content-type"];if(this._formData){console.error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()")}if(isObj&&!this._data){if(Array.isArray(data)){this._data=[]}else if(!this._isHost(data)){this._data={}}}else if(data&&this._data&&this._isHost(this._data)){throw Error("Can't merge these send calls")}if(isObj&&isObject(this._data)){for(var key in data){this._data[key]=data[key]}}else if("string"==typeof data){if(!type)this.type("form");type=this._header["content-type"];if("application/x-www-form-urlencoded"==type){this._data=this._data?this._data+"&"+data:data}else{this._data=(this._data||"")+data}}else{this._data=data}if(!isObj||this._isHost(data)){return this}if(!type)this.type("json");return this};RequestBase.prototype.sortQuery=function(sort){this._sort=typeof sort==="undefined"?true:sort;return this};RequestBase.prototype._finalizeQueryString=function(){var query=this._query.join("&");if(query){this.url+=(this.url.indexOf("?")>=0?"&":"?")+query}this._query.length=0;if(this._sort){var index=this.url.indexOf("?");if(index>=0){var queryArr=this.url.substring(index+1).split("&");if("function"===typeof this._sort){queryArr.sort(this._sort)}else{queryArr.sort()}this.url=this.url.substring(0,index)+"?"+queryArr.join("&")}}};RequestBase.prototype._appendQueryString=function(){console.trace("Unsupported")};RequestBase.prototype._timeoutError=function(reason,timeout,errno){if(this._aborted){return}var err=new Error(reason+timeout+"ms exceeded");err.timeout=timeout;err.code="ECONNABORTED";err.errno=errno;this.timedout=true;this.abort();this.callback(err)};RequestBase.prototype._setTimeouts=function(){var self=this;if(this._timeout&&!this._timer){this._timer=setTimeout(function(){self._timeoutError("Timeout of ",self._timeout,"ETIME")},this._timeout)}if(this._responseTimeout&&!this._responseTimeoutTimer){this._responseTimeoutTimer=setTimeout(function(){self._timeoutError("Response timeout of ",self._responseTimeout,"ETIMEDOUT")},this._responseTimeout)}}},function(module,exports,__webpack_require__){var utils=__webpack_require__(8);module.exports=ResponseBase;function ResponseBase(obj){if(obj)return mixin(obj)}function mixin(obj){for(var key in ResponseBase.prototype){obj[key]=ResponseBase.prototype[key]}return obj}ResponseBase.prototype.get=function(field){return this.header[field.toLowerCase()]};ResponseBase.prototype._setHeaderProperties=function(header){var ct=header["content-type"]||"";this.type=utils.type(ct);var params=utils.params(ct);for(var key in params)this[key]=params[key];this.links={};try{if(header.link){this.links=utils.parseLinks(header.link)}}catch(err){}};ResponseBase.prototype._setStatusProperties=function(status){var type=status/100|0;this.status=this.statusCode=status;this.statusType=type;this.info=1==type;this.ok=2==type;this.redirect=3==type;this.clientError=4==type;this.serverError=5==type;this.error=4==type||5==type?this.toError():false;this.accepted=202==status;this.noContent=204==status;this.badRequest=400==status;this.unauthorized=401==status;this.notAcceptable=406==status;this.forbidden=403==status;this.notFound=404==status}},function(module,exports){exports.type=function(str){return str.split(/ *; */).shift()};exports.params=function(str){return str.split(/ *; */).reduce(function(obj,str){var parts=str.split(/ *= */);var key=parts.shift();var val=parts.shift();if(key&&val)obj[key]=val;return obj},{})};exports.parseLinks=function(str){return str.split(/ *, */).reduce(function(obj,str){var parts=str.split(/ *; */);var url=parts[0].slice(1,-1);var rel=parts[1].split(/ *= */)[1].slice(1,-1);obj[rel]=url;return obj},{})};exports.cleanHeader=function(header,shouldStripCookie){delete header["content-type"];delete header["content-length"];delete header["transfer-encoding"];delete header["host"];if(shouldStripCookie){delete header["cookie"]}return header}},function(module,exports){var ERROR_CODES=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];module.exports=function shouldRetry(err,res){if(err&&err.code&&~ERROR_CODES.indexOf(err.code))return true;if(res&&res.status&&res.status>=500)return true;if(err&&"timeout"in err&&err.code=="ECONNABORTED")return true;if(err&&"crossDomain"in err)return true;return false}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=function(observable){var relations={};var config={};var chats={};observable(relations);observable(config);observable(chats);var getRelations=function getRelations(){return relations};var setRelations=function setRelations(ary){var i=0,len=ary.length,relation,key;for(;i<len;i++){relation=relations.get(ary[i].userid)||new Relation(ary[i]);for(key in ary[i]){if(ary[i].hasOwnProperty(key)){relation.set(key,ary[i][key])}}}};var getConfig=function getConfig(){return config};var setConfig=function setConfig(name,obj){var key;if(!obj){obj=name;config.set(name,obj)}else{for(key in obj){if(obj.hasOwnProperty(key)){config.set(key,obj[key])}}}};var getVoices=function getVoices(userid){chats[userid]=chats[userid]||new VoiceCollection;return chats[userid]};var setVoices=function setVoices(userid,ary){var voices=chats[userid]||new VoiceCollection,i=0,len=ary.length;for(;i<len;i++){voices.add(ary[i])}return chats[userid]=voices};return{getRelations:getRelations,setRelations:setRelations,getConfig:getConfig,setConfig:setConfig,getVoices:getVoices,setVoices:setVoices}}},function(module,exports,__webpack_require__){(function(global,factory){true?factory(exports):typeof define==="function"&&define.amd?define(["exports"],factory):factory(global.riot={})})(this,function(exports){"use strict";var __TAGS_CACHE=[];var __TAG_IMPL={};var GLOBAL_MIXIN="__global_mixin";var ATTRS_PREFIX="riot-";var REF_DIRECTIVES=["ref","data-ref"];var IS_DIRECTIVE="data-is";var CONDITIONAL_DIRECTIVE="if";var LOOP_DIRECTIVE="each";var LOOP_NO_REORDER_DIRECTIVE="no-reorder";var SHOW_DIRECTIVE="show";var HIDE_DIRECTIVE="hide";var RIOT_EVENTS_KEY="__riot-events__";var T_STRING="string";var T_OBJECT="object";var T_UNDEF="undefined";var T_FUNCTION="function";var XLINK_NS="http://www.w3.org/1999/xlink";var SVG_NS="http://www.w3.org/2000/svg";var XLINK_REGEX=/^xlink:(\w+)/;var WIN=typeof window===T_UNDEF?undefined:window;var RE_SPECIAL_TAGS=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?|opt(?:ion|group))$/;var RE_SPECIAL_TAGS_NO_OPTION=/^(?:t(?:body|head|foot|[rhd])|caption|col(?:group)?)$/;var RE_EVENTS_PREFIX=/^on/;var RE_HTML_ATTRS=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;var CASE_SENSITIVE_ATTRIBUTES={viewbox:"viewBox"};var RE_BOOL_ATTRS=/^(?:disabled|checked|readonly|required|allowfullscreen|auto(?:focus|play)|compact|controls|default|formnovalidate|hidden|ismap|itemscope|loop|multiple|muted|no(?:resize|shade|validate|wrap)?|open|reversed|seamless|selected|sortable|truespeed|typemustmatch)$/;var IE_VERSION=(WIN&&WIN.document||{}).documentMode|0;function isBoolAttr(value){return RE_BOOL_ATTRS.test(value)}function isFunction(value){return typeof value===T_FUNCTION}function isObject(value){return value&&typeof value===T_OBJECT}function isUndefined(value){return typeof value===T_UNDEF}function isString(value){return typeof value===T_STRING}function isBlank(value){return isUndefined(value)||value===null||value===""}function isArray(value){return Array.isArray(value)||value instanceof Array}function isWritable(obj,key){var descriptor=Object.getOwnPropertyDescriptor(obj,key);return isUndefined(obj[key])||descriptor&&descriptor.writable}var check=Object.freeze({isBoolAttr:isBoolAttr,isFunction:isFunction,isObject:isObject,isUndefined:isUndefined,isString:isString,isBlank:isBlank,isArray:isArray,isWritable:isWritable});function $$(selector,ctx){return Array.prototype.slice.call((ctx||document).querySelectorAll(selector))}function $(selector,ctx){return(ctx||document).querySelector(selector)}function createFrag(){return document.createDocumentFragment()}function createDOMPlaceholder(){return document.createTextNode("")}function isSvg(el){return!!el.ownerSVGElement}function mkEl(name){return name==="svg"?document.createElementNS(SVG_NS,name):document.createElement(name)}function setInnerHTML(container,html){if(!isUndefined(container.innerHTML)){container.innerHTML=html}else{var doc=(new DOMParser).parseFromString(html,"application/xml");var node=container.ownerDocument.importNode(doc.documentElement,true);container.appendChild(node)}}function toggleVisibility(dom,show){dom.style.display=show?"":"none";dom["hidden"]=show?false:true}function remAttr(dom,name){dom.removeAttribute(name)}function styleObjectToString(style){return Object.keys(style).reduce(function(acc,prop){return acc+" "+prop+": "+style[prop]+";"},"")}function getAttr(dom,name){return dom.getAttribute(name)}function setAttr(dom,name,val){var xlink=XLINK_REGEX.exec(name);if(xlink&&xlink[1]){dom.setAttributeNS(XLINK_NS,xlink[1],val)}else{dom.setAttribute(name,val)}}function safeInsert(root,curr,next){root.insertBefore(curr,next.parentNode&&next)}function walkAttrs(html,fn){if(!html){return}var m;while(m=RE_HTML_ATTRS.exec(html)){fn(m[1].toLowerCase(),m[2]||m[3]||m[4])}}function walkNodes(dom,fn,context){if(dom){var res=fn(dom,context);var next;if(res===false){return}dom=dom.firstChild;while(dom){next=dom.nextSibling;walkNodes(dom,fn,res);dom=next}}}var dom=Object.freeze({$$:$$,$:$,createFrag:createFrag,createDOMPlaceholder:createDOMPlaceholder,isSvg:isSvg,mkEl:mkEl,setInnerHTML:setInnerHTML,toggleVisibility:toggleVisibility,remAttr:remAttr,styleObjectToString:styleObjectToString,getAttr:getAttr,setAttr:setAttr,safeInsert:safeInsert,walkAttrs:walkAttrs,walkNodes:walkNodes});var styleNode;var cssTextProp;var byName={};var remainder=[];var needsInject=false;if(WIN){styleNode=function(){var newNode=mkEl("style");setAttr(newNode,"type","text/css");var userNode=$("style[type=riot]");if(userNode){if(userNode.id){newNode.id=userNode.id}userNode.parentNode.replaceChild(newNode,userNode)}else{document.getElementsByTagName("head")[0].appendChild(newNode)}return newNode}();cssTextProp=styleNode.styleSheet}var styleManager={styleNode:styleNode,add:function add(css,name){if(name){byName[name]=css}else{remainder.push(css)}needsInject=true},inject:function inject(){if(!WIN||!needsInject){return}needsInject=false;var style=Object.keys(byName).map(function(k){return byName[k]}).concat(remainder).join("\n");if(cssTextProp){cssTextProp.cssText=style}else{styleNode.innerHTML=style}}};var skipRegex=function(){var beforeReChars="[{(,;:?=|&!^~>%*/";var beforeReWords=["case","default","do","else","in","instanceof","prefix","return","typeof","void","yield"];var wordsLastChar=beforeReWords.reduce(function(s,w){return s+w.slice(-1)},"");var RE_REGEX=/^\/(?=[^*>/])[^[/\\]*(?:(?:\\.|\[(?:\\.|[^\]\\]*)*\])[^[\\/]*)*?\/[gimuy]*/;var RE_VN_CHAR=/[$\w]/;function prev(code,pos){while(--pos>=0&&/\s/.test(code[pos])){}return pos}function _skipRegex(code,start){var re=/.*/g;var pos=re.lastIndex=start++;var match=re.exec(code)[0].match(RE_REGEX);if(match){var next=pos+match[0].length;pos=prev(code,pos);var c=code[pos];if(pos<0||~beforeReChars.indexOf(c)){return next}if(c==="."){if(code[pos-1]==="."){start=next}}else if(c==="+"||c==="-"){if(code[--pos]!==c||(pos=prev(code,pos))<0||!RE_VN_CHAR.test(code[pos])){start=next}}else if(~wordsLastChar.indexOf(c)){var end=pos+1;while(--pos>=0&&RE_VN_CHAR.test(code[pos])){}if(~beforeReWords.indexOf(code.slice(pos+1,end))){start=next}}}return start}return _skipRegex}();var brackets=function(UNDEF){var REGLOB="g",R_MLCOMMS=/\/\*[^*]*\*+(?:[^*\/][^*]*\*+)*\//g,R_STRINGS=/"[^"\\]*(?:\\[\S\s][^"\\]*)*"|'[^'\\]*(?:\\[\S\s][^'\\]*)*'|`[^`\\]*(?:\\[\S\s][^`\\]*)*`/g,S_QBLOCKS=R_STRINGS.source+"|"+/(?:\breturn\s+|(?:[$\w\)\]]|\+\+|--)\s*(\/)(?![*\/]))/.source+"|"+/\/(?=[^*\/])[^[\/\\]*(?:(?:\[(?:\\.|[^\]\\]*)*\]|\\.)[^[\/\\]*)*?([^<]\/)[gim]*/.source,UNSUPPORTED=RegExp("[\\"+"x00-\\x1F<>a-zA-Z0-9'\",;\\\\]"),NEED_ESCAPE=/(?=[[\]()*+?.^$|])/g,S_QBLOCK2=R_STRINGS.source+"|"+/(\/)(?![*\/])/.source,FINDBRACES={"(":RegExp("([()])|"+S_QBLOCK2,REGLOB),"[":RegExp("([[\\]])|"+S_QBLOCK2,REGLOB),"{":RegExp("([{}])|"+S_QBLOCK2,REGLOB)},DEFAULT="{ }";var _pairs=["{","}","{","}",/{[^}]*}/,/\\([{}])/g,/\\({)|{/g,RegExp("\\\\(})|([[({])|(})|"+S_QBLOCK2,REGLOB),DEFAULT,/^\s*{\^?\s*([$\w]+)(?:\s*,\s*(\S+))?\s+in\s+(\S.*)\s*}/,/(^|[^\\]){=[\S\s]*?}/];var cachedBrackets=UNDEF,_regex,_cache=[],_settings;function _loopback(re){return re}function _rewrite(re,bp){if(!bp){bp=_cache}return new RegExp(re.source.replace(/{/g,bp[2]).replace(/}/g,bp[3]),re.global?REGLOB:"")}function _create(pair){if(pair===DEFAULT){return _pairs}var arr=pair.split(" ");if(arr.length!==2||UNSUPPORTED.test(pair)){throw new Error('Unsupported brackets "'+pair+'"')}arr=arr.concat(pair.replace(NEED_ESCAPE,"\\").split(" "));arr[4]=_rewrite(arr[1].length>1?/{[\S\s]*?}/:_pairs[4],arr);arr[5]=_rewrite(pair.length>3?/\\({|})/g:_pairs[5],arr);arr[6]=_rewrite(_pairs[6],arr);arr[7]=RegExp("\\\\("+arr[3]+")|([[({])|("+arr[3]+")|"+S_QBLOCK2,REGLOB);arr[8]=pair;return arr}function _brackets(reOrIdx){return reOrIdx instanceof RegExp?_regex(reOrIdx):_cache[reOrIdx]}_brackets.split=function split(str,tmpl,_bp){if(!_bp){_bp=_cache}var parts=[],match,isexpr,start,pos,re=_bp[6];var qblocks=[];var prevStr="";var mark,lastIndex;isexpr=start=re.lastIndex=0;while(match=re.exec(str)){lastIndex=re.lastIndex;pos=match.index;if(isexpr){if(match[2]){var ch=match[2];var rech=FINDBRACES[ch];var ix=1;rech.lastIndex=lastIndex;while(match=rech.exec(str)){if(match[1]){if(match[1]===ch){++ix}else if(!--ix){break}}else{rech.lastIndex=pushQBlock(match.index,rech.lastIndex,match[2])}}re.lastIndex=ix?str.length:rech.lastIndex;continue}if(!match[3]){re.lastIndex=pushQBlock(pos,lastIndex,match[4]);continue}}if(!match[1]){unescapeStr(str.slice(start,pos));start=re.lastIndex;re=_bp[6+(isexpr^=1)];re.lastIndex=start}}if(str&&start<str.length){unescapeStr(str.slice(start))}parts.qblocks=qblocks;return parts;function unescapeStr(s){if(prevStr){s=prevStr+s;prevStr=""}if(tmpl||isexpr){parts.push(s&&s.replace(_bp[5],"$1"))}else{parts.push(s)}}function pushQBlock(_pos,_lastIndex,slash){if(slash){_lastIndex=skipRegex(str,_pos)}if(tmpl&&_lastIndex>_pos+2){mark="⁗"+qblocks.length+"~";qblocks.push(str.slice(_pos,_lastIndex));prevStr+=str.slice(start,_pos)+mark;start=_lastIndex}return _lastIndex}};_brackets.hasExpr=function hasExpr(str){return _cache[4].test(str)};_brackets.loopKeys=function loopKeys(expr){var m=expr.match(_cache[9]);return m?{key:m[1],pos:m[2],val:_cache[0]+m[3].trim()+_cache[1]}:{val:expr.trim()}};_brackets.array=function array(pair){return pair?_create(pair):_cache};function _reset(pair){if((pair||(pair=DEFAULT))!==_cache[8]){_cache=_create(pair);_regex=pair===DEFAULT?_loopback:_rewrite;_cache[9]=_regex(_pairs[9])}cachedBrackets=pair}function _setSettings(o){var b;o=o||{};b=o.brackets;Object.defineProperty(o,"brackets",{set:_reset,get:function(){return cachedBrackets},enumerable:true});_settings=o;_reset(b)}Object.defineProperty(_brackets,"settings",{set:_setSettings,get:function(){return _settings}});_brackets.settings=typeof riot!=="undefined"&&riot.settings||{};_brackets.set=_reset;_brackets.skipRegex=skipRegex;_brackets.R_STRINGS=R_STRINGS;_brackets.R_MLCOMMS=R_MLCOMMS;_brackets.S_QBLOCKS=S_QBLOCKS;_brackets.S_QBLOCK2=S_QBLOCK2;return _brackets}();var tmpl=function(){var _cache={};function _tmpl(str,data){if(!str){return str}return(_cache[str]||(_cache[str]=_create(str))).call(data,_logErr.bind({data:data,tmpl:str}))}_tmpl.hasExpr=brackets.hasExpr;_tmpl.loopKeys=brackets.loopKeys;_tmpl.clearCache=function(){_cache={}};_tmpl.errorHandler=null;function _logErr(err,ctx){err.riotData={tagName:ctx&&ctx.__&&ctx.__.tagName,_riot_id:ctx&&ctx._riot_id};if(_tmpl.errorHandler){_tmpl.errorHandler(err)}else if(typeof console!=="undefined"&&typeof console.error==="function"){console.error(err.message);console.log("<%s> %s",err.riotData.tagName||"Unknown tag",this.tmpl);console.log(this.data)}}function _create(str){var expr=_getTmpl(str);if(expr.slice(0,11)!=="try{return "){expr="return "+expr}return new Function("E",expr+";")}var RE_DQUOTE=/\u2057/g;var RE_QBMARK=/\u2057(\d+)~/g;function _getTmpl(str){var parts=brackets.split(str.replace(RE_DQUOTE,'"'),1);var qstr=parts.qblocks;var expr;if(parts.length>2||parts[0]){var i,j,list=[];for(i=j=0;i<parts.length;++i){expr=parts[i];if(expr&&(expr=i&1?_parseExpr(expr,1,qstr):'"'+expr.replace(/\\/g,"\\\\").replace(/\r\n?|\n/g,"\\n").replace(/"/g,'\\"')+'"')){list[j++]=expr}}expr=j<2?list[0]:"["+list.join(",")+'].join("")'}else{expr=_parseExpr(parts[1],0,qstr)}if(qstr.length){expr=expr.replace(RE_QBMARK,function(_,pos){return qstr[pos].replace(/\r/g,"\\r").replace(/\n/g,"\\n")})}return expr}var RE_CSNAME=/^(?:(-?[_A-Za-z\xA0-\xFF][-\w\xA0-\xFF]*)|\u2057(\d+)~):/;var RE_BREND={"(":/[()]/g,"[":/[[\]]/g,"{":/[{}]/g};function _parseExpr(expr,asText,qstr){expr=expr.replace(/\s+/g," ").trim().replace(/\ ?([[\({},?\.:])\ ?/g,"$1");if(expr){var list=[],cnt=0,match;while(expr&&(match=expr.match(RE_CSNAME))&&!match.index){var key,jsb,re=/,|([[{(])|$/g;expr=RegExp.rightContext;key=match[2]?qstr[match[2]].slice(1,-1).trim().replace(/\s+/g," "):match[1];while(jsb=(match=re.exec(expr))[1]){skipBraces(jsb,re)}jsb=expr.slice(0,match.index);expr=RegExp.rightContext;list[cnt++]=_wrapExpr(jsb,1,key)}expr=!cnt?_wrapExpr(expr,asText):cnt>1?"["+list.join(",")+'].join(" ").trim()':list[0]}return expr;function skipBraces(ch,re){var mm,lv=1,ir=RE_BREND[ch];ir.lastIndex=re.lastIndex;while(mm=ir.exec(expr)){if(mm[0]===ch){++lv}else if(!--lv){break}}re.lastIndex=lv?expr.length:ir.lastIndex}}var JS_CONTEXT='"in this?this:'+(typeof window!=="object"?"global":"window")+").",JS_VARNAME=/[,{][\$\w]+(?=:)|(^ *|[^$\w\.{])(?!(?:typeof|true|false|null|undefined|in|instanceof|is(?:Finite|NaN)|void|NaN|new|Date|RegExp|Math)(?![$\w]))([$_A-Za-z][$\w]*)/g,JS_NOPROPS=/^(?=(\.[$\w]+))\1(?:[^.[(]|$)/;function _wrapExpr(expr,asText,key){var tb;expr=expr.replace(JS_VARNAME,function(match,p,mvar,pos,s){if(mvar){pos=tb?0:pos+match.length;if(mvar!=="this"&&mvar!=="global"&&mvar!=="window"){match=p+'("'+mvar+JS_CONTEXT+mvar;if(pos){tb=(s=s[pos])==="."||s==="("||s==="["}}else if(pos){tb=!JS_NOPROPS.test(s.slice(pos))}}return match});if(tb){expr="try{return "+expr+"}catch(e){E(e,this)}"}if(key){expr=(tb?"function(){"+expr+"}.call(this)":"("+expr+")")+'?"'+key+'":""'}else if(asText){expr="function(v){"+(tb?expr.replace("return ","v="):"v=("+expr+")")+';return v||v===0?v:""}.call(this)'}return expr}_tmpl.version=brackets.version="v3.0.8";return _tmpl}();var observable$1=function(el){el=el||{};var callbacks={},slice=Array.prototype.slice;Object.defineProperties(el,{on:{value:function(event,fn){if(typeof fn=="function"){(callbacks[event]=callbacks[event]||[]).push(fn)}return el},enumerable:false,writable:false,configurable:false},off:{value:function(event,fn){if(event=="*"&&!fn){callbacks={}}else{if(fn){var arr=callbacks[event];for(var i=0,cb;cb=arr&&arr[i];++i){if(cb==fn){arr.splice(i--,1)}}}else{delete callbacks[event]}}return el},enumerable:false,writable:false,configurable:false},one:{value:function(event,fn){function on(){el.off(event,on);fn.apply(el,arguments)}return el.on(event,on)},enumerable:false,writable:false,configurable:false},trigger:{value:function(event){var arguments$1=arguments;var arglen=arguments.length-1,args=new Array(arglen),fns,fn,i;for(i=0;i<arglen;i++){args[i]=arguments$1[i+1]}fns=slice.call(callbacks[event]||[],0);for(i=0;fn=fns[i];++i){fn.apply(el,args)}if(callbacks["*"]&&event!="*"){el.trigger.apply(el,["*",event].concat(args))}return el},enumerable:false,writable:false,configurable:false}});return el};function each(list,fn){var len=list?list.length:0;var i=0;for(;i<len;++i){fn(list[i],i)}return list}function contains(array,item){return array.indexOf(item)!==-1}function toCamel(str){return str.replace(/-(\w)/g,function(_,c){return c.toUpperCase()})}function startsWith(str,value){return str.slice(0,value.length)===value}function defineProperty(el,key,value,options){Object.defineProperty(el,key,extend({value:value,enumerable:false,writable:false,configurable:true},options));return el}function extend(src){var obj;var args=arguments;for(var i=1;i<args.length;++i){if(obj=args[i]){for(var key in obj){if(isWritable(src,key)){src[key]=obj[key]}}}}return src}var misc=Object.freeze({each:each,contains:contains,toCamel:toCamel,startsWith:startsWith,defineProperty:defineProperty,extend:extend});var settings$1=extend(Object.create(brackets.settings),{skipAnonymousTags:true,autoUpdate:true});function handleEvent(dom,handler,e){var ptag=this.__.parent;var item=this.__.item;if(!item){while(ptag&&!item){item=ptag.__.item;ptag=ptag.__.parent}}if(isWritable(e,"currentTarget")){e.currentTarget=dom}if(isWritable(e,"target")){e.target=e.srcElement}if(isWritable(e,"which")){e.which=e.charCode||e.keyCode}e.item=item;handler.call(this,e);if(!settings$1.autoUpdate){return}if(!e.preventUpdate){var p=getImmediateCustomParentTag(this);if(p.isMounted){p.update()}}}function setEventHandler(name,handler,dom,tag){var eventName;var cb=handleEvent.bind(tag,dom,handler);dom[name]=null;eventName=name.replace(RE_EVENTS_PREFIX,"");if(!contains(tag.__.listeners,dom)){tag.__.listeners.push(dom)}if(!dom[RIOT_EVENTS_KEY]){dom[RIOT_EVENTS_KEY]={}}if(dom[RIOT_EVENTS_KEY][name]){dom.removeEventListener(eventName,dom[RIOT_EVENTS_KEY][name])}dom[RIOT_EVENTS_KEY][name]=cb;dom.addEventListener(eventName,cb,false)}function updateDataIs(expr,parent,tagName){var tag=expr.tag||expr.dom._tag,ref;var ref$1=tag?tag.__:{};var head=ref$1.head;var isVirtual=expr.dom.tagName==="VIRTUAL";if(tag&&expr.tagName===tagName){tag.update();return}if(tag){if(isVirtual){ref=createDOMPlaceholder();head.parentNode.insertBefore(ref,head)}tag.unmount(true)}if(!isString(tagName)){return}expr.impl=__TAG_IMPL[tagName];if(!expr.impl){return}expr.tag=tag=initChildTag(expr.impl,{root:expr.dom,parent:parent,tagName:tagName},expr.dom.innerHTML,parent);each(expr.attrs,function(a){return setAttr(tag.root,a.name,a.value)});expr.tagName=tagName;tag.mount();if(isVirtual){makeReplaceVirtual(tag,ref||tag.root)}parent.__.onUnmount=function(){var delName=tag.opts.dataIs;arrayishRemove(tag.parent.tags,delName,tag);arrayishRemove(tag.__.parent.tags,delName,tag);tag.unmount()}}function normalizeAttrName(attrName){if(!attrName){return null}attrName=attrName.replace(ATTRS_PREFIX,"");if(CASE_SENSITIVE_ATTRIBUTES[attrName]){attrName=CASE_SENSITIVE_ATTRIBUTES[attrName]}return attrName}function updateExpression(expr){if(this.root&&getAttr(this.root,"virtualized")){return}var dom=expr.dom,attrName=normalizeAttrName(expr.attr),isToggle=contains([SHOW_DIRECTIVE,HIDE_DIRECTIVE],attrName),isVirtual=expr.root&&expr.root.tagName==="VIRTUAL",parent=dom&&(expr.parent||dom.parentNode),isStyleAttr=attrName==="style",isClassAttr=attrName==="class",hasValue,isObj,value;if(expr._riot_id){if(expr.__.wasCreated){expr.update()}else{expr.mount();if(isVirtual){makeReplaceVirtual(expr,expr.root)}}return}if(expr.update){return expr.update()}value=tmpl(expr.expr,isToggle?extend({},Object.create(this.parent),this):this);hasValue=!isBlank(value);isObj=isObject(value);if(isObj){isObj=!isClassAttr&&!isStyleAttr;if(isClassAttr){value=tmpl(JSON.stringify(value),this)}else if(isStyleAttr){value=styleObjectToString(value)}}if(expr.attr&&(!expr.isAttrRemoved||!hasValue||value===false)){remAttr(dom,expr.attr);expr.isAttrRemoved=true}if(expr.bool){value=value?attrName:false}if(expr.isRtag){return updateDataIs(expr,this,value)}if(expr.wasParsedOnce&&expr.value===value){return}expr.value=value;expr.wasParsedOnce=true;if(isObj&&!isToggle){return}if(isBlank(value)){value=""}if(!attrName){value+="";if(parent){expr.parent=parent;if(parent.tagName==="TEXTAREA"){parent.value=value;if(!IE_VERSION){dom.nodeValue=value}}else{dom.nodeValue=value}}return}if(isFunction(value)){setEventHandler(attrName,value,dom,this)}else if(isToggle){toggleVisibility(dom,attrName===HIDE_DIRECTIVE?!value:value)}else{if(expr.bool){dom[attrName]=value}if(attrName==="value"&&dom.value!==value){dom.value=value}if(hasValue&&value!==false){setAttr(dom,attrName,value)}if(isStyleAttr&&dom.hidden){toggleVisibility(dom,false)}}}function updateAllExpressions(expressions){each(expressions,updateExpression.bind(this))}var IfExpr={init:function init(dom,tag,expr){remAttr(dom,CONDITIONAL_DIRECTIVE);this.tag=tag;this.expr=expr;this.stub=createDOMPlaceholder();this.pristine=dom;var p=dom.parentNode;p.insertBefore(this.stub,dom);p.removeChild(dom);return this},update:function update(){this.value=tmpl(this.expr,this.tag);if(this.value&&!this.current){this.current=this.pristine.cloneNode(true);this.stub.parentNode.insertBefore(this.current,this.stub);this.expressions=[];parseExpressions.apply(this.tag,[this.current,this.expressions,true])}else if(!this.value&&this.current){unmountAll(this.expressions);if(this.current._tag){this.current._tag.unmount()}else if(this.current.parentNode){this.current.parentNode.removeChild(this.current)}this.current=null;this.expressions=[]}if(this.value){updateAllExpressions.call(this.tag,this.expressions)}},unmount:function unmount(){unmountAll(this.expressions||[])}};var RefExpr={init:function init(dom,parent,attrName,attrValue){this.dom=dom;this.attr=attrName;this.rawValue=attrValue;this.parent=parent;this.hasExp=tmpl.hasExpr(attrValue);return this},update:function update(){var old=this.value;var customParent=this.parent&&getImmediateCustomParentTag(this.parent);var tagOrDom=this.dom.__ref||this.tag||this.dom;this.value=this.hasExp?tmpl(this.rawValue,this.parent):this.rawValue;if(!isBlank(old)&&customParent){arrayishRemove(customParent.refs,old,tagOrDom)}if(!isBlank(this.value)&&isString(this.value)){if(customParent){arrayishAdd(customParent.refs,this.value,tagOrDom,null,this.parent.__.index)}if(this.value!==old){setAttr(this.dom,this.attr,this.value)}}else{remAttr(this.dom,this.attr)}if(!this.dom.__ref){this.dom.__ref=tagOrDom}},unmount:function unmount(){var tagOrDom=this.tag||this.dom;var customParent=this.parent&&getImmediateCustomParentTag(this.parent);if(!isBlank(this.value)&&customParent){arrayishRemove(customParent.refs,this.value,tagOrDom)}}};function mkitem(expr,key,val,base){var item=base?Object.create(base):{};item[expr.key]=key;if(expr.pos){item[expr.pos]=val}return item}function unmountRedundant(items,tags){var i=tags.length;var j=items.length;while(i>j){i--;remove.apply(tags[i],[tags,i])}}function remove(tags,i){tags.splice(i,1);this.unmount();arrayishRemove(this.parent,this,this.__.tagName,true)}function moveNestedTags(i){var this$1=this;each(Object.keys(this.tags),function(tagName){moveChildTag.apply(this$1.tags[tagName],[tagName,i])})}function move(root,nextTag,isVirtual){if(isVirtual){moveVirtual.apply(this,[root,nextTag])}else{safeInsert(root,this.root,nextTag.root)}}function insert(root,nextTag,isVirtual){if(isVirtual){makeVirtual.apply(this,[root,nextTag])}else{safeInsert(root,this.root,nextTag.root)}}function append(root,isVirtual){if(isVirtual){makeVirtual.call(this,root)}else{root.appendChild(this.root)}}function _each(dom,parent,expr){var mustReorder=typeof getAttr(dom,LOOP_NO_REORDER_DIRECTIVE)!==T_STRING||remAttr(dom,LOOP_NO_REORDER_DIRECTIVE);var tagName=getTagName(dom);var impl=__TAG_IMPL[tagName];var parentNode=dom.parentNode;var placeholder=createDOMPlaceholder();var child=getTag(dom);var ifExpr=getAttr(dom,CONDITIONAL_DIRECTIVE);var tags=[];var isLoop=true;var isAnonymous=!__TAG_IMPL[tagName];var isVirtual=dom.tagName==="VIRTUAL";var oldItems=[];var hasKeys;remAttr(dom,LOOP_DIRECTIVE);expr=tmpl.loopKeys(expr);expr.isLoop=true;if(ifExpr){remAttr(dom,CONDITIONAL_DIRECTIVE)}parentNode.insertBefore(placeholder,dom);parentNode.removeChild(dom);expr.update=function updateEach(){expr.value=tmpl(expr.val,parent);var items=expr.value;var frag=createFrag();var isObject$$1=!isArray(items)&&!isString(items);var root=placeholder.parentNode;if(!root){return}if(isObject$$1){hasKeys=items||false;items=hasKeys?Object.keys(items).map(function(key){return mkitem(expr,items[key],key)}):[]}else{hasKeys=false}if(ifExpr){items=items.filter(function(item,i){if(expr.key&&!isObject$$1){return!!tmpl(ifExpr,mkitem(expr,item,i,parent))}return!!tmpl(ifExpr,extend(Object.create(parent),item))})}each(items,function(item,i){var doReorder=mustReorder&&typeof item===T_OBJECT&&!hasKeys;var oldPos=oldItems.indexOf(item);var isNew=oldPos===-1;var pos=!isNew&&doReorder?oldPos:i;var tag=tags[pos];var mustAppend=i>=oldItems.length;var mustCreate=doReorder&&isNew||!doReorder&&!tag;item=!hasKeys&&expr.key?mkitem(expr,item,i):item;if(mustCreate){tag=new Tag$1(impl,{parent:parent,isLoop:isLoop,isAnonymous:isAnonymous,tagName:tagName,root:dom.cloneNode(isAnonymous),item:item,index:i},dom.innerHTML);tag.mount();if(mustAppend){append.apply(tag,[frag||root,isVirtual])}else{insert.apply(tag,[root,tags[i],isVirtual])}if(!mustAppend){oldItems.splice(i,0,item)}tags.splice(i,0,tag);if(child){arrayishAdd(parent.tags,tagName,tag,true)}}else if(pos!==i&&doReorder){if(contains(items,oldItems[pos])){move.apply(tag,[root,tags[i],isVirtual]);tags.splice(i,0,tags.splice(pos,1)[0]);oldItems.splice(i,0,oldItems.splice(pos,1)[0])}if(expr.pos){tag[expr.pos]=i}if(!child&&tag.tags){moveNestedTags.call(tag,i)}}tag.__.item=item;tag.__.index=i;tag.__.parent=parent;if(!mustCreate){tag.update(item)}});unmountRedundant(items,tags);oldItems=items.slice();root.insertBefore(frag,placeholder)};expr.unmount=function(){each(tags,function(t){t.unmount()})};return expr}function parseExpressions(root,expressions,mustIncludeRoot){var this$1=this;var tree={parent:{children:expressions}};walkNodes(root,function(dom,ctx){var type=dom.nodeType,parent=ctx.parent,attr,expr,tagImpl;if(!mustIncludeRoot&&dom===root){return{parent:parent}}if(type===3&&dom.parentNode.tagName!=="STYLE"&&tmpl.hasExpr(dom.nodeValue)){parent.children.push({dom:dom,expr:dom.nodeValue})}if(type!==1){return ctx}var isVirtual=dom.tagName==="VIRTUAL";if(attr=getAttr(dom,LOOP_DIRECTIVE)){if(isVirtual){setAttr(dom,"loopVirtual",true)}parent.children.push(_each(dom,this$1,attr));return false}if(attr=getAttr(dom,CONDITIONAL_DIRECTIVE)){parent.children.push(Object.create(IfExpr).init(dom,this$1,attr));return false}if(expr=getAttr(dom,IS_DIRECTIVE)){if(tmpl.hasExpr(expr)){parent.children.push({isRtag:true,expr:expr,dom:dom,attrs:[].slice.call(dom.attributes)});return false}}tagImpl=getTag(dom);if(isVirtual){if(getAttr(dom,"virtualized")){dom.parentElement.removeChild(dom)}if(!tagImpl&&!getAttr(dom,"virtualized")&&!getAttr(dom,"loopVirtual")){tagImpl={tmpl:dom.outerHTML}}}if(tagImpl&&(dom!==root||mustIncludeRoot)){if(isVirtual&&!getAttr(dom,IS_DIRECTIVE)){setAttr(dom,"virtualized",true);var tag=new Tag$1({tmpl:dom.outerHTML},{root:dom,parent:this$1},dom.innerHTML);parent.children.push(tag)}else{parent.children.push(initChildTag(tagImpl,{root:dom,parent:this$1},dom.innerHTML,this$1));return false}}parseAttributes.apply(this$1,[dom,dom.attributes,function(attr,expr){if(!expr){return}parent.children.push(expr)}]);return{parent:parent}},tree)}function parseAttributes(dom,attrs,fn){var this$1=this;each(attrs,function(attr){if(!attr){return false}var name=attr.name;var bool=isBoolAttr(name);var expr;if(contains(REF_DIRECTIVES,name)){expr=Object.create(RefExpr).init(dom,this$1,name,attr.value)}else if(tmpl.hasExpr(attr.value)){expr={dom:dom,expr:attr.value,attr:name,bool:bool}}fn(attr,expr)})}var reHasYield=/<yield\b/i;var reYieldAll=/<yield\s*(?:\/>|>([\S\s]*?)<\/yield\s*>|>)/gi;var reYieldSrc=/<yield\s+to=['"]([^'">]*)['"]\s*>([\S\s]*?)<\/yield\s*>/gi;var reYieldDest=/<yield\s+from=['"]?([-\w]+)['"]?\s*(?:\/>|>([\S\s]*?)<\/yield\s*>)/gi;var rootEls={tr:"tbody",th:"tr",td:"tr",col:"colgroup"};var tblTags=IE_VERSION&&IE_VERSION<10?RE_SPECIAL_TAGS:RE_SPECIAL_TAGS_NO_OPTION;var GENERIC="div";var SVG="svg";function specialTags(el,tmpl,tagName){var select=tagName[0]==="o",parent=select?"select>":"table>";el.innerHTML="<"+parent+tmpl.trim()+"</"+parent;parent=el.firstChild;if(select){parent.selectedIndex=-1}else{var tname=rootEls[tagName];if(tname&&parent.childElementCount===1){parent=$(tname,parent)}}return parent}function replaceYield(tmpl,html){if(!reHasYield.test(tmpl)){return tmpl}var src={};html=html&&html.replace(reYieldSrc,function(_,ref,text){src[ref]=src[ref]||text;return""}).trim();return tmpl.replace(reYieldDest,function(_,ref,def){return src[ref]||def||""}).replace(reYieldAll,function(_,def){return html||def||""})}function mkdom(tmpl,html,isSvg$$1){var match=tmpl&&tmpl.match(/^\s*<([-\w]+)/);var tagName=match&&match[1].toLowerCase();var el=mkEl(isSvg$$1?SVG:GENERIC);tmpl=replaceYield(tmpl,html);if(tblTags.test(tagName)){el=specialTags(el,tmpl,tagName)}else{setInnerHTML(el,tmpl)}return el}function Tag$2(el,opts){var ref=this;var name=ref.name;var tmpl=ref.tmpl;var css=ref.css;var attrs=ref.attrs;var onCreate=ref.onCreate;if(!__TAG_IMPL[name]){tag$1(name,tmpl,css,attrs,onCreate);__TAG_IMPL[name].class=this.constructor}mountTo(el,name,opts,this);if(css){styleManager.inject()}return this}function tag$1(name,tmpl,css,attrs,fn){if(isFunction(attrs)){fn=attrs;if(/^[\w-]+\s?=/.test(css)){attrs=css;css=""}else{attrs=""}}if(css){if(isFunction(css)){fn=css}else{styleManager.add(css)}}name=name.toLowerCase();__TAG_IMPL[name]={name:name,tmpl:tmpl,attrs:attrs,fn:fn};return name}function tag2$1(name,tmpl,css,attrs,fn){if(css){styleManager.add(css,name)}__TAG_IMPL[name]={name:name,tmpl:tmpl,attrs:attrs,fn:fn};return name}function mount$1(selector,tagName,opts){var tags=[];var elem,allTags;function pushTagsTo(root){if(root.tagName){var riotTag=getAttr(root,IS_DIRECTIVE),tag;if(tagName&&riotTag!==tagName){riotTag=tagName;setAttr(root,IS_DIRECTIVE,tagName)}tag=mountTo(root,riotTag||root.tagName.toLowerCase(),opts);if(tag){tags.push(tag)}}else if(root.length){each(root,pushTagsTo)}}styleManager.inject();if(isObject(tagName)){opts=tagName;tagName=0}if(isString(selector)){selector=selector==="*"?allTags=selectTags():selector+selectTags(selector.split(/, */));elem=selector?$$(selector):[]}else{elem=selector}if(tagName==="*"){tagName=allTags||selectTags();if(elem.tagName){elem=$$(tagName,elem)}else{var nodeList=[];each(elem,function(_el){return nodeList.push($$(tagName,_el))});elem=nodeList}tagName=0}pushTagsTo(elem);return tags}var mixins={};var globals=mixins[GLOBAL_MIXIN]={};var mixins_id=0;function mixin$1(name,mix,g){if(isObject(name)){mixin$1("__"+mixins_id+++"__",name,true);return}var store=g?globals:mixins;if(!mix){if(isUndefined(store[name])){throw new Error("Unregistered mixin: "+name)}return store[name]}store[name]=isFunction(mix)?extend(mix.prototype,store[name]||{})&&mix:extend(store[name]||{},mix)}function update$1(){return each(__TAGS_CACHE,function(tag){return tag.update()})}function unregister$1(name){__TAG_IMPL[name]=null}var version$1="v3.6.3";var core=Object.freeze({Tag:Tag$2,tag:tag$1,tag2:tag2$1,mount:mount$1,mixin:mixin$1,update:update$1,unregister:unregister$1,version:version$1});var uid=0;function updateOpts(isLoop,parent,isAnonymous,opts,instAttrs){if(isLoop&&isAnonymous){return}var ctx=!isAnonymous&&isLoop?this:parent||this;each(instAttrs,function(attr){if(attr.expr){updateAllExpressions.call(ctx,[attr.expr])}opts[toCamel(attr.name).replace(ATTRS_PREFIX,"")]=attr.expr?attr.expr.value:attr.value})}function setIsMounted(value){defineProperty(this,"isMounted",value)}function Tag$1(impl,conf,innerHTML){if(impl===void 0)impl={};if(conf===void 0)conf={};var opts=extend({},conf.opts),parent=conf.parent,isLoop=conf.isLoop,isAnonymous=!!conf.isAnonymous,skipAnonymous=settings$1.skipAnonymousTags&&isAnonymous,item=conf.item,index=conf.index,instAttrs=[],implAttrs=[],expressions=[],root=conf.root,tagName=conf.tagName||getTagName(root),isVirtual=tagName==="virtual",isInline=!isVirtual&&!impl.tmpl,propsInSyncWithParent=[],dom;if(!skipAnonymous){observable$1(this)}if(impl.name&&root._tag){root._tag.unmount(true)}setIsMounted.call(this,false);defineProperty(this,"__",{isAnonymous:isAnonymous,instAttrs:instAttrs,innerHTML:innerHTML,tagName:tagName,index:index,isLoop:isLoop,isInline:isInline,listeners:[],virts:[],wasCreated:false,tail:null,head:null,parent:null,item:null});defineProperty(this,"_riot_id",++uid);defineProperty(this,"root",root);extend(this,{opts:opts},item);defineProperty(this,"parent",parent||null);defineProperty(this,"tags",{});defineProperty(this,"refs",{});if(isInline||isLoop&&isAnonymous){dom=root}else{if(!isVirtual){root.innerHTML=""}dom=mkdom(impl.tmpl,innerHTML,isSvg(root))}defineProperty(this,"update",function tagUpdate(data){var nextOpts={},canTrigger=this.isMounted&&!skipAnonymous;extend(this,data);updateOpts.apply(this,[isLoop,parent,isAnonymous,nextOpts,instAttrs]);if(canTrigger&&this.isMounted&&isFunction(this.shouldUpdate)&&!this.shouldUpdate(data,nextOpts)){return this}if(isLoop&&isAnonymous){inheritFrom.apply(this,[this.parent,propsInSyncWithParent])}extend(opts,nextOpts);if(canTrigger){this.trigger("update",data)}updateAllExpressions.call(this,expressions);if(canTrigger){this.trigger("updated")}return this}.bind(this));defineProperty(this,"mixin",function tagMixin(){var this$1=this;each(arguments,function(mix){var instance,obj;var props=[];var propsBlacklist=["init","__proto__"];mix=isString(mix)?mixin$1(mix):mix;if(isFunction(mix)){instance=new mix}else{instance=mix}var proto=Object.getPrototypeOf(instance);do{props=props.concat(Object.getOwnPropertyNames(obj||instance))}while(obj=Object.getPrototypeOf(obj||instance));each(props,function(key){if(!contains(propsBlacklist,key)){var descriptor=Object.getOwnPropertyDescriptor(instance,key)||Object.getOwnPropertyDescriptor(proto,key);var hasGetterSetter=descriptor&&(descriptor.get||descriptor.set);if(!this$1.hasOwnProperty(key)&&hasGetterSetter){Object.defineProperty(this$1,key,descriptor)}else{this$1[key]=isFunction(instance[key])?instance[key].bind(this$1):instance[key]}}});if(instance.init){instance.init.bind(this$1)()}});return this}.bind(this));defineProperty(this,"mount",function tagMount(){var this$1=this;root._tag=this;parseAttributes.apply(parent,[root,root.attributes,function(attr,expr){if(!isAnonymous&&RefExpr.isPrototypeOf(expr)){expr.tag=this$1}attr.expr=expr;instAttrs.push(attr)}]);implAttrs=[];walkAttrs(impl.attrs,function(k,v){implAttrs.push({name:k,value:v})});parseAttributes.apply(this,[root,implAttrs,function(attr,expr){if(expr){expressions.push(expr)}else{setAttr(root,attr.name,attr.value)}}]);updateOpts.apply(this,[isLoop,parent,isAnonymous,opts,instAttrs]);var globalMixin=mixin$1(GLOBAL_MIXIN);if(globalMixin&&!skipAnonymous){for(var i in globalMixin){if(globalMixin.hasOwnProperty(i)){this$1.mixin(globalMixin[i])}}}if(impl.fn){impl.fn.call(this,opts)}if(!skipAnonymous){this.trigger("before-mount")}parseExpressions.apply(this,[dom,expressions,isAnonymous]);this.update(item);if(!isAnonymous&&!isInline){while(dom.firstChild){root.appendChild(dom.firstChild)}}defineProperty(this,"root",root);if(!skipAnonymous&&this.parent){var p=getImmediateCustomParentTag(this.parent);p.one(!p.isMounted?"mount":"updated",function(){setIsMounted.call(this$1,true);this$1.trigger("mount")})}else{setIsMounted.call(this,true);if(!skipAnonymous){this.trigger("mount")}}this.__.wasCreated=true;return this}.bind(this));defineProperty(this,"unmount",function tagUnmount(mustKeepRoot){var this$1=this;var el=this.root;var p=el.parentNode;var tagIndex=__TAGS_CACHE.indexOf(this);var ptag;if(!skipAnonymous){this.trigger("before-unmount")}walkAttrs(impl.attrs,function(name){if(startsWith(name,ATTRS_PREFIX)){name=name.slice(ATTRS_PREFIX.length)}remAttr(root,name)});this.__.listeners.forEach(function(dom){Object.keys(dom[RIOT_EVENTS_KEY]).forEach(function(eventName){dom.removeEventListener(eventName,dom[RIOT_EVENTS_KEY][eventName])})});if(tagIndex!==-1){__TAGS_CACHE.splice(tagIndex,1)}if(p||isVirtual){if(parent){ptag=getImmediateCustomParentTag(parent);if(isVirtual){Object.keys(this.tags).forEach(function(tagName){arrayishRemove(ptag.tags,tagName,this$1.tags[tagName])})}else{arrayishRemove(ptag.tags,tagName,this);if(parent!==ptag){arrayishRemove(parent.tags,tagName,this)}}}else{setInnerHTML(el,"")}if(p&&!mustKeepRoot){p.removeChild(el)}}if(this.__.virts){each(this.__.virts,function(v){if(v.parentNode){v.parentNode.removeChild(v)}})}unmountAll(expressions);each(instAttrs,function(a){return a.expr&&a.expr.unmount&&a.expr.unmount()});if(this.__.onUnmount){this.__.onUnmount()}if(!skipAnonymous){if(!this.isMounted){this.trigger("mount")}this.trigger("unmount");this.off("*")}defineProperty(this,"isMounted",false);this.__.wasCreated=false;delete this.root._tag;return this}.bind(this))}function getTag(dom){return dom.tagName&&__TAG_IMPL[getAttr(dom,IS_DIRECTIVE)||getAttr(dom,IS_DIRECTIVE)||dom.tagName.toLowerCase()]}function inheritFrom(target,propsInSyncWithParent){var this$1=this;each(Object.keys(target),function(k){var mustSync=contains(propsInSyncWithParent,k);if(isUndefined(this$1[k])||mustSync){if(!mustSync){propsInSyncWithParent.push(k)}this$1[k]=target[k]}})}function moveChildTag(tagName,newPos){var parent=this.parent;var tags;if(!parent){return}tags=parent.tags[tagName];if(isArray(tags)){tags.splice(newPos,0,tags.splice(tags.indexOf(this),1)[0])}else{arrayishAdd(parent.tags,tagName,this)}}function initChildTag(child,opts,innerHTML,parent){var tag=new Tag$1(child,opts,innerHTML);var tagName=opts.tagName||getTagName(opts.root,true);var ptag=getImmediateCustomParentTag(parent);defineProperty(tag,"parent",ptag);tag.__.parent=parent;arrayishAdd(ptag.tags,tagName,tag);if(ptag!==parent){arrayishAdd(parent.tags,tagName,tag)}return tag}function getImmediateCustomParentTag(tag){var ptag=tag;while(ptag.__.isAnonymous){if(!ptag.parent){break}ptag=ptag.parent}return ptag}function unmountAll(expressions){each(expressions,function(expr){if(expr instanceof Tag$1){expr.unmount(true)}else if(expr.tagName){expr.tag.unmount(true)}else if(expr.unmount){expr.unmount()}})}function getTagName(dom,skipDataIs){var child=getTag(dom);var namedTag=!skipDataIs&&getAttr(dom,IS_DIRECTIVE);return namedTag&&!tmpl.hasExpr(namedTag)?namedTag:child?child.name:dom.tagName.toLowerCase()}function arrayishAdd(obj,key,value,ensureArray,index){var dest=obj[key];var isArr=isArray(dest);var hasIndex=!isUndefined(index);if(dest&&dest===value){return}if(!dest&&ensureArray){obj[key]=[value]}else if(!dest){obj[key]=value}else{if(isArr){var oldIndex=dest.indexOf(value);if(oldIndex===index){return}if(oldIndex!==-1){dest.splice(oldIndex,1)}if(hasIndex){dest.splice(index,0,value)}else{dest.push(value)}}else{obj[key]=[dest,value]}}}function arrayishRemove(obj,key,value,ensureArray){if(isArray(obj[key])){var index=obj[key].indexOf(value);if(index!==-1){obj[key].splice(index,1)}if(!obj[key].length){delete obj[key]}else if(obj[key].length===1&&!ensureArray){obj[key]=obj[key][0]}}else{delete obj[key]}}function mountTo(root,tagName,opts,ctx){var impl=__TAG_IMPL[tagName];var implClass=__TAG_IMPL[tagName].class;var tag=ctx||(implClass?Object.create(implClass.prototype):{});var innerHTML=root._innerHTML=root._innerHTML||root.innerHTML;var conf=extend({root:root,opts:opts},{parent:opts?opts.parent:null});if(impl&&root){Tag$1.apply(tag,[impl,conf,innerHTML])}if(tag&&tag.mount){tag.mount(true);if(!contains(__TAGS_CACHE,tag)){__TAGS_CACHE.push(tag)}}return tag}function makeReplaceVirtual(tag,ref){var frag=createFrag();makeVirtual.call(tag,frag);ref.parentNode.replaceChild(frag,ref)}function makeVirtual(src,target){var this$1=this;var head=createDOMPlaceholder();var tail=createDOMPlaceholder();var frag=createFrag();var sib;var el;this.root.insertBefore(head,this.root.firstChild);this.root.appendChild(tail);this.__.head=el=head;this.__.tail=tail;while(el){sib=el.nextSibling;frag.appendChild(el);this$1.__.virts.push(el);el=sib}if(target){src.insertBefore(frag,target.__.head)}else{src.appendChild(frag)}}function moveVirtual(src,target){var this$1=this;var el=this.__.head,sib;var frag=createFrag();while(el){sib=el.nextSibling;frag.appendChild(el);el=sib;if(el===this$1.__.tail){frag.appendChild(el);src.insertBefore(frag,target.__.head);break}}}function selectTags(tags){if(!tags){var keys=Object.keys(__TAG_IMPL);return keys+selectTags(keys)}return tags.filter(function(t){return!/[^-\w]/.test(t)}).reduce(function(list,t){var name=t.trim().toLowerCase();return list+",["+IS_DIRECTIVE+'="'+name+'"]'},"")}var tags=Object.freeze({getTag:getTag,inheritFrom:inheritFrom,moveChildTag:moveChildTag,initChildTag:initChildTag,getImmediateCustomParentTag:getImmediateCustomParentTag,unmountAll:unmountAll,getTagName:getTagName,arrayishAdd:arrayishAdd,arrayishRemove:arrayishRemove,mountTo:mountTo,makeReplaceVirtual:makeReplaceVirtual,makeVirtual:makeVirtual,moveVirtual:moveVirtual,selectTags:selectTags});var settings=settings$1;var util={tmpl:tmpl,brackets:brackets,styleManager:styleManager,vdom:__TAGS_CACHE,styleNode:styleManager.styleNode,dom:dom,check:check,misc:misc,tags:tags};var Tag=Tag$2;var tag=tag$1;var tag2=tag2$1;var mount=mount$1;var mixin=mixin$1;var update=update$1;var unregister=unregister$1;var version=version$1;var observable=observable$1;var riot$1=extend({},core,{observable:observable$1,settings:settings,util:util});exports.settings=settings;exports.util=util;exports.Tag=Tag;exports.tag=tag;exports.tag2=tag2;exports.mount=mount;exports.mixin=mixin;exports.update=update;exports.unregister=unregister;exports.version=version;exports.observable=observable;exports["default"]=riot$1;Object.defineProperty(exports,"__esModule",{value:true})})}]);